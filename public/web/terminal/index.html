<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Server Terminal</title>
    <style>
      body {
        font-family: sans-serif;
        color: rgb(184, 184, 184);
        text-align: center;
        background-color: rgb(32, 32, 32);
      }
      i {
        color: rgba(0, 0, 0, 0.438);
      }
      a {
        color: rgba(72, 130, 255, 0.26);
      }
      #type_log_yllw {
        color: orange;
      }
      #type_log {
        margin-left: 10px;
        margin-top: 10px;
        color: rgb(196, 196, 196);
      }
      #aa {
        margin-top: 150px;
        height: 300px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      #Logs::-webkit-scrollbar {
        display: none; /* for Chrome, Safari, and Opera */
      }
      #Logs {
        overflow: hidden;
        border-radius: 10px;
        text-align: left;
        background-color: rgb(44, 44, 44);
        height: 550px;
        width: 1000px;
        overflow: auto;
      }
      #error {
        color: red;
      }
      #em_baixo_dos_logs1 {
        margin-top: 170px;
        margin-right: 500px;
        color: rgba(184, 184, 184, 0.26);
      }
      #em_baixo_dos_logs2 {
        margin-top: 170px;
        margin-right: 680px;
      }
      #em_baixo_dos_logs3 {
        margin-top: 170px;
        margin-right: 668px;
      }
    </style>
    <script>
      setTimeout(() => {
        console.clear();
        console.warn(
          `
        Hello world!
        Logs:
        `
        );
        console.warn(
          "DATA LOGS -----------------------------------------------------"
        );
      }, 300);
      const colors = [
        "color: green;",
        "color: orange;",
        "color: purple;",
        "color: rgb(82, 0, 197);",
      ];
      var settedColor = colors[Math.floor(Math.random() * 4)];
      var last_log = "";
      window.onload = () => {
        var elem = document.getElementById("Logs");
        setInterval(() => {
          fetch("/listener/logs/get_all", {
            method: "GET",
          })
            .then((result) => result.json())
            .then((data) => {
              setTimeout(() => {
                if (data.success) {
                  if (data.log != last_log) {
                    last_log = data.log;
                    const oo = data.log.split("\n");
                    for (var i in oo) {
                      if (
                        oo[i].includes("Unbundling libraries to") ||
                        oo[i].includes("Expected file") ||
                        oo[i].includes("Unpacking")
                      ) {
                        delete oo.shift();
                      }
                    }
                    console.warn({
                      length: oo.length + 1,
                      data: oo,
                    });
                    elem.innerHTML = "";
                    elem.innerHTML += `<i id="type_log">Logs:</i><br><br>`;
                    for (var i in oo) {
                      if (oo[i].includes(":")) {
                        var result = null;
                        if (!oo[i].includes("<colorization")) {
                          var two = "";
                          var three = "";
                          var four = "";
                          var five = "";
                          var six = "";

                          if (oo[i].split(":")[2]) {
                            two = oo[i].split(":")[2];
                          }
                          if (oo[i].split(":")[3]) {
                            three = oo[i].split(":")[3];
                          }
                          if (oo[i].split(":")[4]) {
                            four = oo[i].split(":")[4];
                          }
                          if (oo[i].split(":")[5]) {
                            five = oo[i].split(":")[5];
                          }
                          if (oo[i].split(":")[6]) {
                            six = oo[i].split(":")[6];
                          }
                          let things =
                            oo[i].split(":")[0] +
                            ":" +
                            oo[i].split(":")[1] +
                            ":" +
                            oo[i].split(":")[2] +
                            ":";
                          let message = three + four + five + six;
                          result =
                            `<colorization style='${settedColor}'>` +
                            things +
                            "</colorization>" +
                            message;
                        } else {
                          result = oo[i];
                        }
                        elem.innerHTML += `<p number="${i}" id="type_log">${result}</p>`;
                      } else {
                        elem.innerHTML += `<i number="${i}" id="type_log">${oo[i]}</i><br>`;
                      }
                      if (oo[i].includes("Done")) {
                        elem.innerHTML += `<p number="${i}" id="type_log"><colorization style="color: rgb(0, 120, 175);">[${
                          oo[i].split("[")[1].split("]")[0]
                        }] [Client result/WARN]:</colorization> Finished! total of, ${
                          oo.length + 1
                        } logs line start. </p>`;
                      }
                    }
                    elem.scrollTop = elem.scrollHeight;
                  }
                } else {
                  console.warn(data);
                }
              }, 10);
            })
            .catch((err) => console.warn(err));
        }, 300);
      };
    </script>
  </head>
  <body>
    <h1>Web Terminal:</h1>
    <div id="aa">
      <div id="Logs">
        <img
          src="../../images/loading.gif"
          alt="loading.gif"
          id="loading_gif"
          style="
            text-align: center;
            margin-top: 230px;
            margin-left: 470px;
            height: 50px;
          "
        />
      </div>
    </div>
    <p id="em_baixo_dos_logs1">This terminal is running on a notebook!</p>
    <a id="em_baixo_dos_logs2" href="../..">Back to main</a><br />
    <!---
    <a
      id="em_baixo_dos_logs3"
      href="../../../log.log"
      download="MCServer_last.log"
      >Download logs</a
    >
    --->

    <footer>
      <p>Thank you <3</p>
      <a href="https://github.com/RamiresOliv" target="_blank"
        >Github - RamiresOliv</a
      >
    </footer>
  </body>
</html>
